<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Telnet Printer ‚Äî Interfaccia Web</title>
<link rel="stylesheet" href="styles.css">
<!-- EMERGENCY SECURITY GUARD -->
<script>
// EMERGENCY AUTH GUARD - IMPROVED VERSION
(function() {
    'use strict';
    console.log('üõ°Ô∏è IMPROVED AUTH GUARD ACTIVATED');
    
    // Check if we're on a protected page
    if (window.location.pathname.includes('/printer/') || 
        window.location.pathname.includes('/admin/') ||
        window.location.pathname.includes('/profile')) {
        
        console.log('üìç Protected page detected, checking authentication...');
        
        // Check for valid token
        const token = localStorage.getItem('accessToken');
        
        if (!token) {
            console.log('‚ùå No access token found, redirecting to login');
            localStorage.clear();
            sessionStorage.clear();
            alert('üîí Accesso negato. Devi effettuare il login.');
            window.location.href = '/login.html';
            return;
        }
        
        // Token exists, let the main script verify it
        console.log('‚úÖ Token found, proceeding with verification...');
    }
})();
</script>
</head>
<body>
    <div class="card">
        <div class="header-section">
            <div class="title-section">
                <h1>Telnet Printer ‚Äî Interfaccia Web</h1>
                <p class="lead">Inserisci IP/porta e invia testo o file alla stampante</p>
            </div>
            <div class="user-menu">
                <div id="userInfo" class="user-info">Caricamento...</div>
                <div class="menu-buttons">
                    <button id="profileBtn" class="menu-btn" title="Il mio profilo">üë§ Profilo</button>
                    <button id="adminPanelBtn" class="menu-btn admin-only" style="display:none;" title="Pannello amministratore">üõ†Ô∏è Admin</button>
                    <button id="logoutBtn" class="menu-btn logout" title="Logout">üö™ Logout</button>
                </div>
            </div>
        </div>

    <div class="row">
      <div style="flex:1">
        <label>IP stampante</label>
        <input id="host" type="text" placeholder="192.168.1.100" value="192.168.1.100">
      </div>
      <div style="width:120px">
        <label>Porta</label>
        <input id="port" type="number" value="9100">
      </div>
    </div>

    <div style="margin-bottom:12px">
      <label>Testo da stampare</label>
      <textarea id="text">Hello from web interface\n</textarea>
    </div>

    <div class="row">
      <div style="flex:1">
        <label>Carica file (solo testo / binario semplice)</label>
        <input id="file" type="file">
      </div>
      <div style="width:200px;align-self:end">
        <div class="controls">
          <button id="sendBtn">Invia alla stampante</button>
          <button id="clearLogBtn" class="secondary">Pulisci log</button>
        </div>
      </div>
    </div>
  <div class="container">
    <h1>Generatore di codici</h1>
    
    <label for="codeType">Tipo di codice:</label>
    <select id="codeType">

    </select>
   <div id="optionsContainer"> 
    <label for="options">Opzioni:</label>
  <div class="nascosto" id="Opzioni">
    <label for="codeText">Testo/URL:</label>
    <input type="text" id="optionsText" placeholder="Inserisci testo o URL">
            </div>
    <button id="generateBtn">Genera codice</button>
    <button id="clearBtn">Pulisci</button>
              <button id="adminPanelBtn" style="display:none;">Pannello Amministratore</button>
    <div id="log"></div>
    <div id="output"></div>
  </div>

 

    
     
  </div>
   <div style="margin-bottom:8px">
      <div class="small">Log:</div>
      <div id="logArea" class="log"></div>
    </div>
    <script src="script.js"> 
</script>
</body>
</html>
